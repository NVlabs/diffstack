{
    "registered_name": "AFPredStack",
    "train": {
        "logging": {
            "terminal_output_to_txt": true,
            "log_tb": false,
            "log_wandb": true,
            "wandb_project_name": "diffstack",
            "log_every_n_steps": 10,
            "flush_every_n_steps": 100
        },
        "save": {
            "enabled": true,
            "every_n_steps": 1000,
            "best_k": 10,
            "save_best_rollout": false,
            "save_best_validation": true
        },
        "rollout": {
            "save_video": true,
            "enabled": false,
            "every_n_steps": 5000,
            "warm_start_n_steps": 1
        },
        "training": {
            "batch_size": 100,
            "num_steps": 200000,
            "num_data_workers": 8
        },
        "validation": {
            "enabled": true,
            "batch_size": 32,
            "num_data_workers": 6,
            "every_n_steps": 500,
            "num_steps_per_epoch": 50
        },
        "parallel_strategy": "ddp",
        "rebuild_cache": false,
        "on_ngc": false,
        "amp": false,
        "auto_batch_size": false,
        "max_batch_size": 1000,
        "gradient_clip_val": 0.5,
        "trajdata_source_train": "train",
        "trajdata_source_valid": "val",
        "trajdata_source_test": null,
        "trajdata_source_root": "nusc_trainval",
        "trajdata_val_source_root": null,
        "trajdata_test_source_root": null,
        "dataset_path": "SET-THIS-THROUGH-TRAIN-SCRIPT-ARGS",
        "datamodule_class": "UnifiedDataModule",
        "ego_only": true,
        "test": {
            "enabled": false,
            "batch_size": 32,
            "num_data_workers": 6,
            "every_n_steps": 500,
            "num_steps_per_epoch": 50
        }
    },
    "env": {
        "name": "nusc_trainval",
        "rasterizer": {
            "raster_size": 224,
            "pixel_size": 0.5,
            "ego_center": [
                -0.75,
                0.0
            ]
        },
        "data_generation_params": {
            "other_agents_num": 10,
            "max_agents_distance": 30,
            "yaw_correction_speed": 1.0
        },
        "simulation": {
            "distance_th_close": 30,
            "num_simulation_steps": 50,
            "start_frame_index": 0,
            "vectorize_lane": "ego"
        },
        "incl_neighbor_map": false,
        "incl_vector_map": true,
        "incl_raster_map": false,
        "remove_single_successor": false,
        "calc_lane_graph": true,
        "max_num_lanes": 15,
        "num_lane_pts": 32,
        "remove_parked": false
    },
    "stack": {
        "predictor": {
            "name": "agentformer",
            "seed": 1,
            "load_map": false,
            "dynamic_type": "Unicycle",
            "step_time": 0.1,
            "history_num_frames": 10,
            "future_num_frames": 20,
            "traj_scale": 10,
            "nz": 32,
            "sample_k": 4,
            "tf_model_dim": 256,
            "tf_ff_dim": 512,
            "tf_nhead": 8,
            "tf_dropout": 0.1,
            "z_tau": {
                "start": 0.5,
                "finish": 0.0001,
                "decay": 0.5
            },
            "input_type": [
                "scene_norm",
                "vel",
                "heading"
            ],
            "fut_input_type": [
                "scene_norm",
                "vel",
                "heading"
            ],
            "dec_input_type": [
                "heading"
            ],
            "pred_type": "dynamic",
            "sn_out_type": "norm",
            "sn_out_heading": false,
            "pos_concat": true,
            "rand_rot_scene": false,
            "use_map": true,
            "pooling": "mean",
            "agent_enc_shuffle": false,
            "vel_heading": false,
            "max_agent_len": 128,
            "agent_enc_learn": false,
            "use_agent_enc": false,
            "motion_dim": 2,
            "forecast_dim": 2,
            "z_type": "gaussian",
            "nlayer": 6,
            "ar_detach": true,
            "pred_scale": 1.0,
            "pos_offset": false,
            "learn_prior": true,
            "discrete_rot": false,
            "map_global_rot": false,
            "ar_train": true,
            "max_train_agent": 100,
            "num_eval_samples": 5,
            "UAC": false,
            "loss_cfg": {
                "kld": {
                    "min_clip": 1.0
                },
                "sample": {
                    "weight": 1.0,
                    "k": 20
                }
            },
            "loss_weights": {
                "prediction_loss": 1.0,
                "kl_loss": 1.0,
                "collision_loss": 3.0,
                "EC_collision_loss": 5.0,
                "diversity_loss": 0.3,
                "deviation_loss": 0.1
            },
            "scene_orig_all_past": false,
            "conn_dist": 100000.0,
            "scene_centric": true,
            "stage": 2,
            "num_frames_per_stage": 10,
            "ego_conditioning": true,
            "perturb": {
                "enabled": true,
                "N_pert": 1,
                "OU": {
                    "theta": 0.8,
                    "sigma": 2.0,
                    "scale": [
                        1.0,
                        0.3
                    ]
                }
            },
            "map_encoder": {
                "model_architecture": "resnet18",
                "image_shape": [
                    3,
                    224,
                    224
                ],
                "feature_dim": 32,
                "spatial_softmax": {
                    "enabled": false,
                    "kwargs": {
                        "num_kp": 32,
                        "temperature": 1.0,
                        "learnable_temperature": false
                    }
                }
            },
            "context_encoder": {
                "nlayer": 2
            },
            "future_decoder": {
                "nlayer": 2,
                "out_mlp_dim": [
                    512,
                    256
                ]
            },
            "future_encoder": {
                "nlayer": 2
            },
            "optim_params": {
                "policy": {
                    "learning_rate": {
                        "initial": 0.0001,
                        "decay_factor": 0.1,
                        "epoch_schedule": []
                    },
                    "regularization": {
                        "L2": 0.0
                    }
                }
            }
        },
        "stack_type": "pred"
    },
    "eval": {
        "name": null,
        "env": "nusc",
        "dataset_path": null,
        "eval_class": "",
        "seed": 0,
        "ckpt_root_dir": "checkpoints/",
        "ckpt": {
            "dir": null,
            "ngc_job_id": null,
            "ckpt_dir": null,
            "ckpt_key": null
        },
        "eval": {
            "batch_size": 100,
            "num_steps": null,
            "num_data_workers": 8
        },
        "log_image_frequency": null,
        "log_all_image": false,
        "trajdata_source_root": "nusc_trainval",
        "trajdata_source_eval": "val"
    },
    "name": "test",
    "root_dir": "predictor_agentformer_trained_models/",
    "seed": 1,
    "devices": {
        "num_gpus": 1
    }
}